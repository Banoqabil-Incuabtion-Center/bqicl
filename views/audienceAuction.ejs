<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIVE AUCTION | ICL Season 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --icl-green: #38b000;
            --glow-color: rgba(56, 176, 0, 0.6);
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: radial-gradient(circle at center, #050a05 0%, #000000 100%);
            color: white;
        }

        .font-heading {
            font-family: 'Orbitron', sans-serif;
        }

        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .responsive-bid {
            font-size: clamp(3rem, 12vw, 8rem);
            line-height: 1;
            text-shadow: 0 0 40px var(--glow-color);
        }

        .responsive-name {
            font-size: clamp(2rem, 7vw, 4rem);
            line-height: 1.1;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .float-anim {
            animation: float 5s ease-in-out infinite;
        }

        .sport-grid {
            background-image: radial-gradient(rgba(56, 176, 0, 0.1) 1px, transparent 1px);
            background-size: 30px 30px;
        }
    </style>
</head>

<body class="sport-grid min-h-screen flex flex-col pt-24 overflow-x-hidden">
    <%- include('partials/publicNavbar') %>

        <main class="flex-grow flex items-center justify-center p-4 md:p-8">
            <div id="waiting-ui" class="text-center px-4">
                <h1
                    class="text-6xl md:text-9xl font-heading font-black tracking-tighter animate-pulse mb-4 text-gray-800">
                    ICL AUCTION</h1>
                <p
                    class="text-lg md:text-2xl text-lime-500 font-mono tracking-[0.2em] md:tracking-[0.5em] uppercase italic">
                    Waiting for Next Player...</p>
            </div>

            <div id="active-ui" class="hidden w-full max-w-6xl flex flex-col items-center gap-8 py-6">
                <div
                    class="glass float-anim w-full rounded-[3rem] lg:rounded-[4rem] p-8 md:p-12 relative overflow-hidden border border-white/10 shadow-emerald-500/5 shadow-2xl">
                    <div class="flex flex-col lg:flex-row items-center gap-12 lg:gap-16">
                        <div class="relative w-56 h-56 md:w-80 md:h-80 flex-shrink-0">
                            <div class="absolute inset-0 bg-lime-500/20 blur-3xl rounded-full"></div>
                            <img id="proj-img" src=""
                                class="relative w-full h-full object-cover rounded-[2rem] md:rounded-[3rem] border-2 border-white/10 shadow-2xl transition-opacity duration-300">
                        </div>

                        <div class="flex-grow w-full text-center lg:text-left space-y-8">
                            <div>
                                <h2 id="proj-name"
                                    class="responsive-name font-heading font-black uppercase tracking-tighter mb-4 italic">
                                    ---</h2>
                                <div class="h-1.5 w-32 bg-lime-500 rounded-full mx-auto lg:mx-0"></div>
                            </div>

                            <div class="grid grid-cols-2 gap-4 md:gap-8">
                                <div class="glass p-4 rounded-2xl border border-white/5 bg-white/2">
                                    <p class="text-[10px] text-gray-400 font-black uppercase tracking-widest mb-1">
                                        Category</p>
                                    <p id="proj-cat"
                                        class="text-sm md:text-xl font-heading font-bold text-lime-400 truncate uppercase">
                                        ---</p>
                                </div>
                                <div class="glass p-4 rounded-2xl border border-white/5 bg-white/2">
                                    <p class="text-[10px] text-gray-400 font-black uppercase tracking-widest mb-1">
                                        Current Leader</p>
                                    <p id="proj-bidder"
                                        class="text-sm md:text-xl font-heading font-bold text-white truncate italic uppercase">
                                        ---</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="w-full text-center">
                    <p
                        class="text-lime-400/60 text-sm md:text-xl font-black uppercase tracking-[0.3em] md:tracking-[0.5em] mb-4">
                        Current Bid</p>
                    <div id="proj-bid"
                        class="responsive-bid font-heading font-black text-lime-500 flex justify-center items-center italic">
                        $0
                    </div>
                </div>
            </div>
        </main>

        <footer
            class="py-12 border-t border-white/5 mt-auto opacity-50 text-center text-xs font-bold tracking-[0.2em] uppercase">
            &copy; <%= new Date().getFullYear() %> BICC INCUBATION CENTER
        </footer>

        <script>
            const waitingUI = document.getElementById('waiting-ui');
            const activeUI = document.getElementById('active-ui');
            const projImg = document.getElementById('proj-img');
            const projName = document.getElementById('proj-name');
            const projCat = document.getElementById('proj-cat');
            const projBid = document.getElementById('proj-bid');
            const projBidder = document.getElementById('proj-bidder');

            function updateUI(data) {
                if (!data.isSessionActive || !data.auction || !data.auction.player) {
                    waitingUI.classList.remove('hidden');
                    activeUI.classList.add('hidden');
                    return;
                }

                waitingUI.classList.add('hidden');
                activeUI.classList.remove('hidden');

                const player = data.auction.player;
                const currentBid = data.auction.currentBid;

                projName.textContent = player.name;
                projCat.textContent = player.category || 'PLAYER';

                if (projImg.src !== player.playerImage) {
                    projImg.style.opacity = '0';
                    setTimeout(() => {
                        projImg.src = player.playerImage || '/images/default-player.png';
                        projImg.style.opacity = '1';
                    }, 300);
                }

                projBid.textContent = '$' + currentBid.toLocaleString();

                if (data.auction.highestBidder) {
                    projBidder.textContent = data.auction.highestBidder.name;
                    projBidder.classList.remove('opacity-30');
                } else {
                    projBidder.textContent = 'NO BIDS';
                    projBidder.classList.add('opacity-30');
                }
            }

            async function pollState() {
                try {
                    const res = await fetch('/api/auction/state');
                    const data = await res.json();
                    updateUI(data);
                } catch (err) {
                    console.error('Polling error:', err);
                }
            }

            pollState();
            setInterval(pollState, 1000);
        </script>
</body>

</html>